<div class="center">
<span *ngIf="!lancer, else qcmLancer">
<!-- <div class="card border-success mb-3" style="max-width: 20rem;">   ceci pour afficher un cadre qui fait au plus 20 rem de large-->
<div class="card border-success mb-3 center" >
    <img style="height: 200px; width: 100%; display: block;" src="https://image.jimcdn.com/app/cms/image/transf/none/path/s5f3909cce3072a25/image/id366849d1b3234f7/version/1506546440/stand-up-paddle-%C3%A0-waterfun-la-tranche-sur-mer.jpg" alt="Card image">
    <div class="card-header"><h1>{{qcm.body}}</h1></div>
    <div class="card-body">
       <h4 class="card-title">id du QCM : {{qcm.id}}</h4>
       auteur du QCM :<h2 class="card-text"> {{qcm.designerPseudo}}</h2>
      <p class="card-text">id des questions : <span *ngFor="let questionId of qcm.questionsId">
          {{questionId}} </span></p>
          theme du QCM :<h2 class="card-title"> {{qcm.topic}}</h2>
    </div>
  </div>
      <button class="btn btn-secondary" (click)="lancerQcm()">Lancer le QCM</button></span>

<ng-template #qcmLancer>
  <div class="progress-bar" [ngStyle]="{'width': progress, 'background-color':
  'blue'}"></div>
  <span *ngIf="!corriger, else questionCorriger">

<!-- affichage de la carte contenant la question et les réponses-->
<div class="card mb-3">
  <h5 class="card-header">question n° {{questionnumber}} sur {{totalquestion}}</h5>
  <div class="card-body">
    <img style="height: 200px;" src="http://www.paddlehouse.fr/image/data/paddle_yoga_2018_2.jpg" alt="Card image">
    <div class="card-body">
      <h5 class="card-text">commentaire sur contenu media de la question</h5>
    </div>
    <h1 class="card-title">{{question.body}}</h1>
    <h6 class="card-subtitle text-muted" hidden>id de la question : {{question.id}}</h6>
  </div>

  <div class="blockanswers">
      <span *ngFor="let answer of question.answersPlayableDto; let index=index" class="btn-group buttonsgroup">
          <input type="checkbox"
          [value]="reponsesAnswersUser[index]"
          [checked]="reponsesAnswersUser[index]"
          [id]="reponsesAnswersUser[index]"
          hidden>
            <!-- bouton faisant varier la valeur de la checkbox, pour contenir text, animations btn,... -->
            <button class="button"
            [ngClass]="{buttonclicked : reponsesAnswersUser[index]}"
            (click)="reponsesAnswersUser[index] = !(reponsesAnswersUser[index])" >
            <strong >
            {{answer.body}}
            </strong>
          </button>
    </span>
  </div>
  <!-- le bouton n'apparait que si la question est chargée -->
  <div *ngIf="question.id != 0"  class="card-footer text-muted">
    <button class="btn btn-secondary" (click)="lancerQuestionCorriger()">Valider</button>
  </div>
</div>
</span>
<br/>
</ng-template>    <!-- fin affichage de la carte contenant la question et les réponses proposées-->
<ng-template #questionCorriger>     <!-- affichage de la carte correction de la question-->
  <span *ngIf="!bilan, else afficherBilan">




<!-- affichage de la carte correction-->
<div class="card mb-3" [ngClass]="{success : reponsesQCMUser[qIndex], fail :!reponsesQCMUser[qIndex] }">
  <h5 class="card-header">question n° {{questionnumber}} sur {{totalquestion}}</h5>
  <div class="card-body">
    <img style="height: 200px;" src="http://www.paddlehouse.fr/image/data/paddle_yoga_2018_2.jpg" alt="Card image">
    <div class="card-body">

    <h5 class="card-text">commentaire sur contenu media de la question</h5>
  </div>
    <h1 class="card-title">{{question.body}}</h1>
    <h6 class="card-subtitle text-muted" hidden>id de la question : {{question.id}}</h6>
    <span *ngIf="reponsesQCMUser[qIndex]"><h2 class="text-success"> la reponse à la question est Correct, BRAVO</h2></span>
    <span *ngIf="!reponsesQCMUser[qIndex]"><h2 class="text-danger"> Il y a des erreurs, voyez la correction</h2></span>
    <span *ngIf="reponsesAttendus.commentPostAnswer"> Notes : {{reponsesAttendus.commentPostAnswer}}</span>
  </div>




  <div class="blockanswers">
    <span *ngFor="let answer of question.answersPlayableDto; let index=index" class="btn-group buttonsgroup">
        <div>
        <input type="checkbox"
          [value]="reponsesAnswersUser[index]"
          [checked]="reponsesAnswersUser[index]"
          [id]="reponsesAnswersUser[index]"
          hidden
          disabled>
            <button class="buttonblocked"
            [ngClass]="{buttonblockedclickedcorrect : reponsesAnswersUser[index]&&trueReponseAnswerUser[index],
               buttonblockedclickedfalse : reponsesAnswersUser[index]&&!trueReponseAnswerUser[index],
               buttonblockedfalse : !reponsesAnswersUser[index]&&!trueReponseAnswerUser[index]}"
            (click)="reponsesAnswersUser[index] = !(reponsesAnswersUser[index])"
            disabled>
            <strong>
             {{answer.body}}
            </strong>
          <br/>
             <em>
              {{varAnswersCorrection[index].commentPostAnswer}}
             </em>
          </button>
        </div>

    </span>

  </div>

  <div class="card-footer text-muted">
    <p *ngIf="!thisIsTheEnd">
      <!-- <button onclick="lancerQcm(), lancer = !lancer">Lancer le QCM</button> -->
      <button class="btn btn-secondary" (click)="nextQuestion()">question suivante</button>

      </p>
      <p *ngIf="thisIsTheEnd">
          <!-- <button onclick="lancerQcm(), lancer = !lancer">Lancer le QCM</button> -->
          <button class="btn btn-secondary" (click)="bilanQCM()">Terminer le QCM</button>

      </p>
  </div>
</div>     <!--fin affichage de la carte correction-->




  <!-- <br/>
  question id : {{question.id}} <br/>
  question : {{question.body}}<br/>
  ####################<br/>
  <span *ngFor="let answer of question.answersPlayableDto; let index=index">
   id reponse :  {{answer.id}} <br/>
  body reponse : {{answer.body}} <br/>
  id de la reponse : {{varAnswersCorrection[index].id}}<br/>
  valeur attendu rep : {{varAnswersCorrection[index].expectedAnswer}}<br/>
  comment rep : {{varAnswersCorrection[index].commentPostAnswer}}<br/>
  reponse de l'utilisateur : {{reponsesAnswersUser[index]}}<br/>
  c'est donc une : {{trueReponseAnswerUser[index]}}<br/>
   reponse id : {{mapRep[answer.id].id}}

####################<br/></span>
 réponses attendus
 id question :  {{reponsesAttendus.id}} <br/>
 comment post question : {{reponsesAttendus.commentPostAnswer}} <br/> -->
<!-- <span *ngFor="let answer of reponsesAttendus.answersCorrectionDto">
id de la reponse : {{answer.id}} <br/>
reponse : {{answer.expectedAnswer}} <br/>
comment : {{answer.commentPostAnswer}} <br/>
####################<br/></span> -->
<!--
<p *ngIf="!thisIsTheEnd, else terminerQcm">
<p *ngIf="!thisIsTheEnd">
 <button onclick="lancerQcm(), lancer = !lancer">Lancer le QCM</button>
<button (click)="nextQuestion()">question suivante</button>

</p>
<p *ngIf="thisIsTheEnd">
     <button onclick="lancerQcm(), lancer = !lancer">Lancer le QCM</button>
    <button (click)="bilanQCM()">Terminer le QCM</button>

</p> -->

</span>
</ng-template>

</div>
<ng-template #afficherBilan>
  ceci est la fin du QCM<br/>
  affichage du bilan pour l'utilisateur ........ <br/>

   <button btn btn-primary [routerLink]="['/qcmList']">retour liste des QCM</button>
</ng-template>
